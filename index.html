<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Renamer</title>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: auto; padding: 20px; text-align: center; }
        .container { border: 2px dashed #ccc; padding: 20px; cursor: pointer; }
        #file-name-input { width: 80%; padding: 8px; margin: 10px 0; }
        #rename-button { padding: 10px 20px; cursor: pointer; }
        .warning { color: #d9534f; margin-top: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <h1>File Renamer</h1>
    <p>Upload a file to rename it and download the new version.</p>

    <div class="container" id="drop-area">
        <p>Drag & drop a file here, or click to select a file.</p>
        <input type="file" id="file-input" hidden />
    </div>

    <div id="controls" style="display: none;">
        <p>Current file: <strong id="current-file-name"></strong></p>
        <p>Current file type: <strong id="current-file-type"></strong></p>
        <p>Enter new file name (including file type):</p>
        <input type="text" id="file-name-input" placeholder="e.g., new-document.pdf" />
        <button id="rename-button">Rename and Download</button>
        <div class="warning">
            WARNING: Changing the file type (e.g., from `.jpg` to `.txt`) may malform the file and make it unusable.
        </div>
    </div>

    <script>
        const fileInput = document.getElementById('file-input');
        const dropArea = document.getElementById('drop-area');
        const controls = document.getElementById('controls');
        const fileNameInput = document.getElementById('file-name-input');
        const renameButton = document.getElementById('rename-button');
        const currentFileNameDisplay = document.getElementById('current-file-name');
        const currentFileTypeDisplay = document.getElementById('current-file-type');
        let uploadedFile = null;

        // Handle file selection via click
        dropArea.addEventListener('click', () => fileInput.click());

        // Handle file drop events
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        dropArea.addEventListener('drop', handleDrop, false);
        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }

        // Handle file selection from input
        fileInput.addEventListener('change', (e) => handleFiles(e.target.files));

        function handleFiles(files) {
            if (files.length === 0) return;
            uploadedFile = files[0];
            const fileName = uploadedFile.name;
            const fileType = fileName.split('.').pop();
            currentFileNameDisplay.textContent = fileName;
            currentFileTypeDisplay.textContent = fileType || 'None';
            fileNameInput.value = fileName;
            controls.style.display = 'block';
        }

        renameButton.addEventListener('click', () => {
            if (!uploadedFile) {
                alert('Please upload a file first.');
                return;
            }

            const newFileName = fileNameInput.value.trim();
            if (!newFileName) {
                alert('Please enter a new file name.');
                return;
            }

            // Create a new File object with the updated name
            const renamedFile = new File([uploadedFile], newFileName, { type: uploadedFile.type });

            // Create a download link for the new file
            const downloadLink = document.createElement('a');
            downloadLink.href = URL.createObjectURL(renamedFile);
            downloadLink.download = newFileName;

            // Trigger the download
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
            URL.revokeObjectURL(downloadLink.href); // Clean up the URL object
        });
    </script>

</body>
</html>
